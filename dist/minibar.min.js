/*!
* MiniBar 0.5.1
* http://mobius.ovh/
*
* Released under the MIT license
*/
!function(e){"use strict";var t,s=window,n=document,o=n.body,i={x:"left",y:"top"},r={x:"width",y:"height"},a={x:"scrollLeft",y:"scrollTop"},c={x:"scrollWidth",y:"scrollHeight"},l={x:"offsetWidth",y:"offsetHeight"},d={x:"pageX",y:"pageY"},f=function(e,t){for(var s=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s[i]=o[i])}return s},h={css:function(e,t){var n=e&&e.style,o="[object Object]"===Object.prototype.toString.call(t);if(n){if(!t)return s.getComputedStyle(e);o&&u(t,(function(e,t){e in n||(e="-webkit-"+e),n[e]=t+("string"==typeof t||"opacity"===e?"":"px")}))}},rect:function(e){var t=s,i=e.getBoundingClientRect(),r=n.documentElement||o.parentNode||o,a=void 0!==t.pageXOffset?t.pageXOffset:r.scrollLeft,c=void 0!==t.pageYOffset?t.pageYOffset:r.scrollTop;return{x:i.left+a,y:i.top+c,x2:i.left+i.width+a,y2:i.top+i.height+c,height:Math.round(i.height),width:Math.round(i.width)}},classList:{contains:function(e,t){if(e)return e.classList?e.classList.contains(t):!!e.className&&!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},add:function(e,t){h.classList.contains(e,t)||(e.classList?e.classList.add(t):e.className=e.className.trim()+" "+t)},remove:function(e,t){h.classList.contains(e,t)&&(e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," "))},toggle:function(e,t,s){var n=this.contains(e,t)?!0!==s&&"remove":!1!==s&&"add";n&&this[n](e,t)}},on:function(e,t,s){e.addEventListener(t,s,!1)},off:function(e,t,s){e.removeEventListener(t,s)},isCollection:function(e){return Array.isArray(e)||e instanceof HTMLCollection||e instanceof NodeList},scrollWidth:function(){var e,t=n.createElement("div");return t.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",n.body.appendChild(t),e=t.offsetWidth-t.clientWidth,n.body.removeChild(t),e}},u=function(e,t,s){if("[object Object]"===Object.prototype.toString.call(e))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(s,n,e[n]);else for(var o=0,i=e.length;o<i;o++)t.call(s,o,e[o])},m=s.requestAnimationFrame||(t=0,s.webkitRequestAnimationFrame||s.mozRequestAnimationFrame||function(e){var s,n=(new Date).getTime();return s=Math.max(0,16-(n-t)),t=n+s,setTimeout((function(){e(n+s)}),s)}),p=s.cancelAnimationFrame||void clearTimeout(void 0),v=function(e,t){this.container="string"==typeof e?n.querySelector(e):e,this.config={barType:"default",minBarSize:10,alwaysShowBars:!1,horizontalMouseScroll:!1,scrollX:!0,scrollY:!0,navButtons:!1,scrollAmount:10,wheelScrollAmount:100,mutationObserver:{attributes:!1,childList:!0,subtree:!0},onInit:function(){},onUpdate:function(){},onStart:function(){},onScroll:function(){},onEnd:function(){},classes:{container:"mb-container",content:"mb-content",track:"mb-track",bar:"mb-bar",visible:"mb-visible",progress:"mb-progress",hover:"mb-hover",scrolling:"mb-scrolling",textarea:"mb-textarea",wrapper:"mb-wrapper",nav:"mb-nav",btn:"mb-button",btns:"mb-buttons",increase:"mb-increase",decrease:"mb-decrease",item:"mb-item",itemVisible:"mb-item-visible",itemPartial:"mb-item-partial",itemHidden:"mb-item-hidden"}},t?this.config=f({},this.config,t):s.MiniBarOptions&&(this.config=f({},this.config,s.MiniBarOptions)),this.css=s.getComputedStyle(this.container),this.size=h.scrollWidth(),this.textarea="textarea"===this.container.nodeName.toLowerCase(),this.bars={x:{},y:{}},this.tracks={x:{},y:{}},this.lastX=0,this.lastY=0,this.scrollDirection={x:0,y:0},this.events={};for(var o=["scroll","mouseenter","mousedown","mousemove","mouseup","wheel"],i=0;i<o.length;i++)this.events[o[i]]=this["_"+o[i]].bind(this);this.events.update=this.update.bind(this),this.events.debounce=function(e,t,s){var n;return function(){var o=this,i=arguments,r=s&&!n;clearTimeout(n),n=setTimeout((function(){n=null,s||e.apply(o,i)}),t),r&&e.apply(o,i)}}(this.events.update,50),this.init()},b=v.prototype;b.init=function(){var e=this,t=e.config,o=e.events;if(!e.initialised){if(e.textarea)e.content=e.container,e.container=n.createElement("div"),h.classList.add(e.container,t.classes.textarea),e.wrapper=n.createElement("div"),h.classList.add(e.wrapper,t.classes.wrapper),e.container.appendChild(e.wrapper),e.content.parentNode.insertBefore(e.container,e.content),e.content.addEventListener("input",(function(t){e.update()}));else for(e.content=n.createElement("div");e.container.firstChild;)e.content.appendChild(e.container.firstChild);if(h.classList.add(e.container,t.classes.container),h.classList.add(e.content,t.classes.content),t.alwaysShowBars&&h.classList.add(e.container,t.classes.visible),u(e.tracks,(function(s,i){if(e.bars[s].node=n.createElement("div"),i.node=n.createElement("div"),h.classList.add(i.node,t.classes.track),h.classList.add(i.node,t.classes.track+"-"+s),h.classList.add(e.bars[s].node,t.classes.bar),i.node.appendChild(e.bars[s].node),t.navButtons){var r=n.createElement("button"),c=n.createElement("button"),l=n.createElement("div"),d=t.scrollAmount;r.className=t.classes.btn+" "+t.classes.decrease,c.className=t.classes.btn+" "+t.classes.increase,l.className=t.classes.btns+" "+t.classes.btns+"-"+s,l.appendChild(r),l.appendChild(i.node),l.appendChild(c),e.container.appendChild(l),h.classList.add(e.container,t.classes.nav),h.on(l,"mousedown",(function(t){var n=t.target;if(p(e.frame),n===c||n===r){var o=e.content[a[s]],i=function(t){switch(e.content[a[s]]=o,n){case r:o-=d;break;case c:o+=d}e.frame=m(i)};i()}})),h.on(l,"mouseup",(function(t){var n=t.target,o=5*d;p(e.frame),n!==c&&n!==r||e.scrollBy(n===r?-o:o,s)}))}else e.container.appendChild(i.node);"progress"===t.barType?(h.classList.add(i.node,t.classes.progress),h.on(i.node,"mousedown",o.mousedown)):h.on(i.node,"mousedown",o.mousedown),h.on(i.node,"mouseenter",(function(n){h.classList.add(e.container,t.classes.hover+"-"+s)})),h.on(i.node,"mouseleave",(function(n){e.down||h.classList.remove(e.container,t.classes.hover+"-"+s)}))})),e.textarea?e.wrapper.appendChild(e.content):e.container.appendChild(e.content),"static"===e.css.position&&(e.manualPosition=!0,e.container.style.position="relative"),t.observableItems){const s=this.getItems();if(s.length&&"IntersectionObserver"in window){e.items=s;for(var i=[],r=0;r<1;r+=.01)i.push(r);var c=function(e,s){e.forEach((e=>{var s=e.target,n=e.intersectionRatio,o=e.isIntersecting,i=o&&n>=1,r=!o&&n<=0,a=o&&n>0&&n<1;h.classList.toggle(s,t.classes.itemVisible,i),h.classList.toggle(s,t.classes.itemPartial,a),h.classList.toggle(s,t.classes.itemHidden,r)}))};this.intersectionObserver=new IntersectionObserver(c,{root:null,rootMargin:"0px",threshold:i}),u(s,(function(t,s){e.intersectionObserver.observe(s)}))}}if(e.update(),h.on(e.content,"scroll",o.scroll),h.on(e.container,"mouseenter",o.mouseenter),t.horizontalMouseScroll&&h.on(e.content,"wheel",o.wheel),h.on(s,"resize",o.debounce),h.on(n,"DOMContentLoaded",o.update),h.on(s,"load",o.update),"MutationObserver"in window){c=function(t,s){if(e.intersectionObserver)for(var n of t)if("childList"==n.type){for(var o of n.addedNodes)e.intersectionObserver.observe(o);for(var o of n.removedNodes)e.intersectionObserver.unobserve(o)}e.intersectionObserver&&(e.items=e.getItems()),e.update()};this.mutationObserver=new MutationObserver(c),this.mutationObserver.observe(this.content,this.config.mutationObserver)}e.initialised=!0,setTimeout((function(){e.config.onInit.call(e,e.getData())}),10)}},b.getItems=function(){const e=this.config;let t;return"string"==typeof e.observableItems&&(t=this.content.querySelectorAll(e.observableItems)),(e.observableItems instanceof HTMLCollection||e.observableItems instanceof NodeList)&&(t=[].slice.call(e.observableItems)),t},b.getData=function(e){var t=this.content;const s=t.scrollTop,n=t.scrollLeft,o=t.scrollHeight,i=t.scrollWidth,r=t.offsetWidth,a=t.offsetHeight,c=this.size;return{scrollTop:s,scrollLeft:n,scrollHeight:o,scrollWidth:i,offsetWidth:r,offsetHeight:a,containerRect:this.rect,barSize:c}},b.scrollTo=function(e,t){void 0===t&&(t="y");var s,n=this.getData();"string"==typeof e?"start"===e?s=-n[a[t]]:"end"===e&&(s=n[c[t]]-n[l[t]]-n[a[t]]):s=e-n[a[t]],this.scrollBy(s,t)},b.scrollBy=function(e,t,s,n){if(void 0===t&&(t="y"),0!==s){void 0===s&&(s=250),n=n||function(e,t,s,n){return-s*(e/=n)*(e-2)+t};var o=this,i=Date.now(),r=o.content[a[t]],c=function(){var l=Date.now()-i;if(l>s)return p(o.frame),void(o.content[a[t]]=Math.ceil(r+e));o.content[a[t]]=Math.ceil(n(l,r,e,s)),o.frame=m(c)};o.frame=c()}else this.content[a[t]]+=e},b.scrollToTop=function(){this.scrollTo(0)},b.scrollToBottom=function(){var e=this.getData();this.scrollTo(e.scrollHeight-e.offsetHeight)},b.update=function(){var e=this,t=e.config,s=e.content,n=e.size;e.rect=h.rect(e.container),e.scrollTop=s.scrollTop,e.scrollLeft=s.scrollLeft,e.scrollHeight=s.scrollHeight,e.scrollWidth=s.scrollWidth,e.offsetWidth=s.offsetWidth,e.offsetHeight=s.offsetHeight,e.clientWidth=s.clientWidth,e.clientHeight=s.clientHeight;var o=e.scrollWidth>e.offsetWidth&&!e.textarea,i=e.scrollHeight>e.offsetHeight;if(h.classList.toggle(e.container,"mb-scroll-x",o&&t.scrollX&&!t.hideBars),h.classList.toggle(e.container,"mb-scroll-y",i&&t.scrollY&&!t.hideBars),h.css(s,{overflowX:o?"auto":"",overflowY:i?"auto":"",marginBottom:o?-n:"",paddingBottom:o?n:"",marginRight:i?-n:"",paddingRight:i&&!t.hideBars?n:""}),e.scrollX=o,e.scrollY=i,u(e.tracks,(function(t,s){f(s,h.rect(s.node)),f(e.bars[t],h.rect(e.bars[t].node))})),e.updateBars(),e.wrapperPadding=0,e.textarea){var r=h.css(e.wrapper);e.wrapperPadding=parseInt(r.paddingTop,10)+parseInt(r.paddingBottom,10),!e.down&&e.content.selectionStart>=e.content.value.length&&(e.content.scrollTop=e.scrollToBottom())}this.config.onUpdate.call(this,this.getData())},b.updateBar=function(e){var t=this,s={},n=r,o=c,l=t.config,d=t.tracks[e][n[e]],f=t.rect[n[e]]-t.wrapperPadding,u=t.content[a[e]],p=d/t[o[e]],v=u/(t[o[e]]-f);"progress"===l.barType?s[n[e]]=Math.floor(d*v):(s[n[e]]=Math.max(Math.floor(p*f),l.minBarSize),s[i[e]]=Math.floor((d-s[n[e]])*v)),m((function(){h.css(t.bars[e].node,s)}))},b.updateBars=function(){u(this.bars,(function(e,t){this.updateBar(e)}),this)},b.destroy=function(){var e=this,t=e.config,n=e.container;if(e.initialised){for(h.off(n,"mouseenter",e.events.mouseenter),h.off(s,"resize",e.events.debounce),h.classList.remove(n,t.classes.visible),h.classList.remove(n,t.classes.container),h.classList.remove(n,t.classes.nav),u(e.tracks,(function(e,s){n.removeChild(t.navButtons?s.node.parentNode:s.node),h.classList.remove(n,"mb-scroll-"+e)}));e.content.firstChild;)n.appendChild(e.content.firstChild);n.removeChild(e.content),e.manualPosition&&(n.style.position=""),e.bars={x:{},y:{}},e.tracks={x:{},y:{}},e.content=null,e.mutationObserver&&(e.mutationObserver.disconnect(),e.mutationObserver=!1),t.observableItems&&(e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=!1),u(e.items,(function(e,s){const n=s.node||s;h.classList.remove(n,t.classes.item),h.classList.remove(n,t.classes.itemVisible),h.classList.remove(n,t.classes.itemPartial),h.classList.remove(n,t.classes.itemHidden)}))),e.initialised=!1}},b._scroll=function(e){const t=this.getData(!0);t.scrollLeft>this.lastX?this.scrollDirection.x=1:t.scrollLeft<this.lastX&&(this.scrollDirection.x=-1),t.scrollTop>this.lastY?this.scrollDirection.y=1:t.scrollTop<this.lastY&&(this.scrollDirection.y=-1),this.updateBars(),this.config.onScroll.call(this,t),this.lastX=t.scrollLeft,this.lastY=t.scrollTop},b._wheel=function(e){e.preventDefault();var t=this.config;this.scrollBy(e.deltaY*t.wheelScrollAmount,"x")},b._mouseenter=function(e){this.updateBars()},b._mousedown=function(e){e.preventDefault();var t=this,s=t.config,o="progress"===s.barType?"tracks":"bars",i=e.target===t[o].x.node?"x":"y";if(h.classList.contains(e.target,"mb-track")){i=e.target===t.tracks.x.node?"x":"y";var a=t.tracks[i],l=a[r[i]],f=(e[d[i]]-a[i])/l*(t.content[c[i]]-t.rect[r[i]]);return this.scrollTo(f,i)}t.down=!0,t.currentAxis=i,t.update(),h.classList.add(t.container,s.classes.visible),h.classList.add(t.container,s.classes.scrolling+"-"+i),"progress"===s.barType?(t.origin={x:e.pageX-t.tracks[i].x,y:e.pageY-t.tracks[i].y},t._mousemove(e)):t.origin={x:e.pageX-t.bars[i].x,y:e.pageY-t.bars[i].y},h.on(n,"mousemove",t.events.mousemove),h.on(n,"mouseup",t.events.mouseup)},b._mousemove=function(e){e.preventDefault();var t,s,n=this,o=this.origin,i=this.currentAxis,l=n.tracks[i],f=l[r[i]],h="progress"===n.config.barType;t=(h?e[d[i]]-l[i]:e[d[i]]-o[i]-l[i])/f,s=h?t*(n.content[c[i]]-n.rect[r[i]]):t*n[c[i]],m((function(){n.content[a[i]]=s}))},b._mouseup=function(e){var t=this,s=t.config,o=t.events;h.classList.toggle(t.container,s.classes.visible,s.alwaysShowBars),h.classList.remove(t.container,s.classes.scrolling+"-"+t.currentAxis),h.classList.contains(e.target,s.classes.bar)||(h.classList.remove(t.container,s.classes.hover+"-x"),h.classList.remove(t.container,s.classes.hover+"-y")),t.currentAxis=null,t.down=!1,h.off(n,"mousemove",o.mousemove),h.off(n,"mouseup",o.mouseup)},e.MiniBar=v}(this);